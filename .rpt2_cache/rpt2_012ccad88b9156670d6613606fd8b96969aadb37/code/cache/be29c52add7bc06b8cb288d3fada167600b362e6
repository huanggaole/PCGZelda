{
  "code": "import Player from \"../character/Player\";\r\nimport BulletFactory from \"../map/BulletFactory\";\r\nimport Character from \"../character/Character\";\r\nexport class FireArrow extends Laya.Script {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.damage = 1;\r\n    }\r\n    onUpdate() {\r\n        let owner = this.owner;\r\n        if (owner.x < 0 || owner.y < 0 || owner.x > 960 || owner.y > 480) {\r\n            this.removeOwner(owner);\r\n        }\r\n    }\r\n    onTriggerEnter(other) {\r\n        if (this.owner && other.owner) {\r\n            let bullet = other.owner.getComponent(FireArrow);\r\n            let owner = this.owner;\r\n            if (bullet) {\r\n                return;\r\n            }\r\n            let player = other.owner.getComponent(Player);\r\n            if (player) {\r\n                if (player && !player.invincibleStatus) {\r\n                    player.hurtFrame = 20;\r\n                    player.HP -= this.damage;\r\n                }\r\n                this.removeOwner(owner);\r\n            }\r\n            else {\r\n                let character = other.owner.getComponent(Character);\r\n                if (character) {\r\n                }\r\n                else {\r\n                    let rb = owner.getComponent(Laya.RigidBody);\r\n                    if (owner.y < other.owner.y || owner.y > other.owner.y + other.owner.height - 5) {\r\n                        rb.setVelocity({ x: -rb.linearVelocity.x, y: rb.linearVelocity.y });\r\n                    }\r\n                    else {\r\n                        rb.setVelocity({ x: rb.linearVelocity.x, y: -rb.linearVelocity.y });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    removeOwner(owner) {\r\n        let rg = owner.getComponent(Laya.RigidBody);\r\n        let bc = owner.getComponent(Laya.BoxCollider);\r\n        if (rg) {\r\n            rg.enabled = false;\r\n        }\r\n        if (bc) {\r\n            bc.enabled = false;\r\n        }\r\n        if (bc) {\r\n            owner._destroyComponent(bc);\r\n        }\r\n        if (rg) {\r\n            owner._destroyComponent(rg);\r\n        }\r\n        owner._destroyAllComponent();\r\n        BulletFactory.mainsp.removeChild(owner);\r\n        Laya.Pool.recover('BulletType', owner);\r\n    }\r\n}\r\nFireArrow.skin = \"Bullet/Fire.png\";\r\nFireArrow.scale = 2;\r\nFireArrow.width = 8;\r\nFireArrow.height = 5;\r\nFireArrow.speed = 5;\r\n",
  "references": [
    "/Users/huanggaole/PCGZelda/src/character/Player.ts",
    "/Users/huanggaole/PCGZelda/src/map/BulletFactory.ts",
    "/Users/huanggaole/PCGZelda/src/character/Character.ts"
  ]
}

{
  "code": "export class GameControl extends Laya.Image {\r\n    constructor(_player) {\r\n        super();\r\n        this.player = _player;\r\n        this.width = Laya.Browser.width;\r\n        this.height = Laya.Browser.height;\r\n        this.dirR = new Laya.Sprite();\r\n        this.proR = new Laya.Sprite();\r\n        this.proR.graphics.drawCircle(0, 0, 5, \"#FFFFFF\");\r\n        this.proR.graphics.drawCircle(0, 0, 75, \"#878787\");\r\n        this.dirR.visible = false;\r\n        this.proR.visible = false;\r\n        this.proR.zOrder = 1001;\r\n        this.dirR.zOrder = 1002;\r\n        this.addChild(this.dirR);\r\n        this.addChild(this.proR);\r\n        this.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);\r\n        this.on(Laya.Event.MOUSE_UP, this, this.onMouseUp);\r\n        this.on(Laya.Event.MOUSE_OUT, this, this.onMouseUp);\r\n    }\r\n    onMouseDown() {\r\n        this.dirR.pos(Laya.stage.mouseX, Laya.stage.mouseY);\r\n        this.dirR.alpha = 0.6;\r\n        this.dirR.graphics.drawCircle(0, 0, 25, \"#A9AAAB\");\r\n        this.proR.pos(Laya.stage.mouseX, Laya.stage.mouseY);\r\n        this.proR.alpha = 0.5;\r\n        this.dirR.visible = true;\r\n        this.proR.visible = true;\r\n        Laya.stage.on(Laya.Event.MOUSE_MOVE, this, this.onMouseMove);\r\n    }\r\n    onMouseUp() {\r\n        Laya.stage.off(Laya.Event.MOUSE_MOVE, this, this.onMouseMove);\r\n        this.dirR.visible = false;\r\n        this.proR.visible = false;\r\n    }\r\n    dis(ax, ay, bx, by) {\r\n        let dx = ax - bx;\r\n        let dy = ay - by;\r\n        return Math.sqrt(dx * dx + dy * dy);\r\n    }\r\n    onMouseMove(e) {\r\n        let dis = this.dis(this.proR.x, this.proR.y, Laya.stage.mouseX, Laya.stage.mouseY);\r\n        let ang = Math.atan2(Laya.stage.mouseY - this.proR.y, Laya.stage.mouseX - this.proR.x);\r\n        if (dis < 200) {\r\n            if (dis > 50) {\r\n                this.dirR.pos(this.proR.x + Math.cos(ang) * 50, this.proR.y + Math.sin(ang) * 50);\r\n                this.player.setDirection(Math.cos(ang), (Math.sin(ang)));\r\n            }\r\n            else {\r\n                this.dirR.pos(Laya.stage.mouseX, Laya.stage.mouseY);\r\n                this.player.setDirection(Math.cos(ang) * dis / 50, (Math.sin(ang) * dis / 50));\r\n            }\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "/Users/huanggaole/PCGZelda/src/character/player.ts"
  ]
}

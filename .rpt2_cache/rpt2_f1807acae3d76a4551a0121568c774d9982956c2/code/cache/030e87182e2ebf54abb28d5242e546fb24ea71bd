{
  "code": "import Character, { CharacterAction } from \"./Character\";\r\nimport Player from \"./Player\";\r\nimport BattleScene from \"../scene/BattleScene\";\r\nimport BulletFactory from \"../map/BulletFactory\";\r\nimport { FireArrow } from \"../bullet/FireArrow\";\r\nexport default class SandEnemy2 extends Character {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.AItick = 0;\r\n        this.maxHP = 5;\r\n        this.damage = 1;\r\n    }\r\n    onStart() {\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.speed = 2.0;\r\n        this.frame = 0;\r\n        this.AItick = 0;\r\n        this.stepindex = 0;\r\n        this.directindex = 0;\r\n        this.action == CharacterAction.RandomWalk;\r\n        this.rigidbody = this.owner.getComponent(Laya.RigidBody);\r\n    }\r\n    onUpdate() {\r\n        super.onUpdate();\r\n        this.AI();\r\n    }\r\n    addExp() {\r\n        super.addExp();\r\n        Player.exp += 5;\r\n        BattleScene.Lv.text = \"lv.\" + Player.Level + \" exp/next:\" + Player.exp + \"/\" + Player.maxExp;\r\n    }\r\n    doShoot() {\r\n        let owner = this.owner;\r\n        BulletFactory.initBullet(FireArrow, owner.x, owner.y, this.dirx, this.diry);\r\n    }\r\n    AI() {\r\n        this.AItick++;\r\n        if (this.action == CharacterAction.Attack) {\r\n            if (this.AItick == 30) {\r\n                this.doShoot();\r\n            }\r\n            if (this.AItick == 100) {\r\n                this.AItick = 0;\r\n                this.action = CharacterAction.RandomWalk;\r\n            }\r\n            return;\r\n        }\r\n        if (this.AItick >= 100) {\r\n            this.onStopMove();\r\n            this.dirx = (BattleScene.player.x - this.owner.x);\r\n            this.diry = (BattleScene.player.y - this.owner.y);\r\n            let mod = Math.sqrt(this.dirx * this.dirx + this.diry * this.diry);\r\n            this.dirx /= mod;\r\n            this.diry /= mod;\r\n            this.doTurnAround();\r\n            this.AItick = 0;\r\n            this.action = CharacterAction.Attack;\r\n        }\r\n        else {\r\n            if (Math.random() < 0.05) {\r\n                this.onSetRandomWalk();\r\n            }\r\n        }\r\n        this.doMove();\r\n    }\r\n    onTriggerEnter(other) {\r\n        if (this.owner && other.owner) {\r\n            let character = other.owner.getComponent(Player);\r\n            if (character && !character.invincibleStatus) {\r\n                character.hurtFrame = 20;\r\n                character.HP -= this.damage;\r\n            }\r\n        }\r\n    }\r\n}\r\nSandEnemy2.BattlePoint = 3;\r\nSandEnemy2.skinname = \"Enemy/1.png\";\r\n",
  "references": [
    "/Users/huanggaole/PCGZelda/src/character/Character.ts",
    "/Users/huanggaole/PCGZelda/src/character/Player.ts",
    "/Users/huanggaole/PCGZelda/src/scene/BattleScene.ts",
    "/Users/huanggaole/PCGZelda/src/map/BulletFactory.ts",
    "/Users/huanggaole/PCGZelda/src/bullet/IceArrow.ts",
    "/Users/huanggaole/PCGZelda/src/bullet/FireArrow.ts"
  ]
}

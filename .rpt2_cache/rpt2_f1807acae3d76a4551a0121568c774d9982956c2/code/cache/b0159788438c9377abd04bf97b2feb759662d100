{
  "code": "export default class BulletFactory {\r\n    constructor(battlesprite) {\r\n        BulletFactory.mainsp = battlesprite;\r\n    }\r\n    static initBullet(BulletScript, x, y, dirx, diry) {\r\n        let bl = Laya.Pool.getItemByClass('BulletType', Laya.Image);\r\n        let comps = bl.getComponents(Laya.Script);\r\n        if (comps) {\r\n            for (let i = 0; i < comps.length; i++) {\r\n                bl._destroyComponent(comps[i]);\r\n            }\r\n        }\r\n        bl.skin = BulletScript.skin;\r\n        let rot = 0;\r\n        if (dirx == 0) {\r\n            if (diry > 0) {\r\n                rot = 90;\r\n            }\r\n            else {\r\n                rot = 270;\r\n            }\r\n        }\r\n        else {\r\n            rot = Math.atan2(diry, dirx) * 180 / 3.1415926;\r\n        }\r\n        bl.rotation = rot;\r\n        bl.x = x + 24 - BulletScript.width / 2;\r\n        bl.y = y + 24 - BulletScript.height / 2;\r\n        BulletFactory.mainsp.addChild(bl);\r\n        bl.scale(BulletScript.scale, BulletScript.scale);\r\n        let rigid = bl.getComponent(Laya.RigidBody);\r\n        if (!rigid) {\r\n            rigid = bl.addComponent(Laya.RigidBody);\r\n        }\r\n        rigid.type = \"dynamic\";\r\n        rigid.gravityScale = 0;\r\n        rigid.setVelocity({ x: dirx * BulletScript.speed, y: diry * BulletScript.speed });\r\n        let collider = bl.getComponent(Laya.BoxCollider);\r\n        if (!collider) {\r\n            collider = bl.addComponent(Laya.BoxCollider);\r\n        }\r\n        collider.width = BulletScript.width;\r\n        collider.height = BulletScript.height;\r\n        collider.isSensor = true;\r\n        let bs = bl.getComponent(Laya.Script);\r\n        if (!bs) {\r\n            bs = bl.addComponent(BulletScript);\r\n        }\r\n        bs = new BulletScript();\r\n        BulletFactory.bulletlist.push(bl);\r\n    }\r\n    static clearBullet() {\r\n        for (let i = 0; i < BulletFactory.bulletlist.length; i++) {\r\n            Laya.Pool.recover('BulletType', BulletFactory.bulletlist[i]);\r\n            this.mainsp.removeChild(BulletFactory.bulletlist[i]);\r\n        }\r\n        BulletFactory.bulletlist = [];\r\n    }\r\n}\r\nBulletFactory.bulletlist = [];\r\n",
  "references": []
}

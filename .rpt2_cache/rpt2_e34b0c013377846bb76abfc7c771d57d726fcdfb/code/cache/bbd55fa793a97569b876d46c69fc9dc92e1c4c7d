{
  "code": "import { RegionType } from \"../script/Region\";\r\nimport GrassEnemy1 from \"../character/GrassEnemy1\";\r\nimport SandEnemy1 from \"../character/SandEnemy1\";\r\nimport SnowEnemy1 from \"../character/SnowEnemy1\";\r\nimport LavaEnemy1 from \"../character/LavaEnemy1\";\r\nimport GrassEnemy2 from \"../character/GrassEnemy2\";\r\nimport SnowEnemy2 from \"../character/SnowEnemy2\";\r\nimport SandEnemy2 from \"../character/SandEnemy2\";\r\nexport default class EnemyFactory {\r\n    constructor(battlesprite) {\r\n        this.grassEnemies = [GrassEnemy1, GrassEnemy2];\r\n        this.sandEnemies = [SandEnemy1, SandEnemy2];\r\n        this.snowEnemies = [SnowEnemy1, SnowEnemy2];\r\n        this.lavaEnemies = [LavaEnemy1];\r\n        EnemyFactory.mainsp = battlesprite;\r\n        EnemyFactory.enemylist = [];\r\n    }\r\n    initEnemy(regiontype, enemyforce, battlemap) {\r\n        let Enemies = [];\r\n        if (regiontype == RegionType.Grass) {\r\n            Enemies = this.grassEnemies;\r\n        }\r\n        if (regiontype == RegionType.Desert) {\r\n            Enemies = this.sandEnemies;\r\n        }\r\n        if (regiontype == RegionType.Snow) {\r\n            Enemies = this.snowEnemies;\r\n        }\r\n        if (regiontype == RegionType.Lava) {\r\n            Enemies = this.lavaEnemies;\r\n        }\r\n        while (enemyforce > 0) {\r\n            let Enemy = Enemies[Math.floor(Math.random() * Enemies.length)];\r\n            if (Enemy.BattlePoint > enemyforce) {\r\n                continue;\r\n            }\r\n            let fc = Laya.Pool.getItemByClass('EnemyType', Laya.FontClip);\r\n            fc.skin = Enemy.skinname;\r\n            fc.sheet = \"一八匕厂 刀儿二几 力人入十 又川寸大\";\r\n            fc.scaleX = fc.scaleY = 3;\r\n            fc.value = \"一\";\r\n            let xindex = Math.floor(Math.random() * 8);\r\n            let yindex = Math.floor(Math.random() * 3);\r\n            while (true) {\r\n                if (battlemap[yindex + 1][xindex + 1] == 0) {\r\n                    break;\r\n                }\r\n                else {\r\n                    xindex = Math.floor(Math.random() * 8);\r\n                    yindex = Math.floor(Math.random() * 3);\r\n                }\r\n            }\r\n            fc.x = 96 * (xindex + 1) + Math.floor(32 + Math.random() * 32);\r\n            fc.y = 96 * (yindex + 1) + Math.floor(32 + Math.random() * 32);\r\n            let rigid = fc.getComponent(Laya.RigidBody);\r\n            if (!rigid) {\r\n                rigid = fc.addComponent(Laya.RigidBody);\r\n            }\r\n            rigid.type = \"dynamic\";\r\n            rigid.gravityScale = 0;\r\n            rigid.allowRotation = false;\r\n            let collider = fc.getComponent(Laya.BoxCollider);\r\n            if (!collider) {\r\n                collider = fc.addComponent(Laya.BoxCollider);\r\n            }\r\n            collider.width = collider.height = 16;\r\n            let enemy = fc.getComponent(Laya.Script);\r\n            if (enemy) {\r\n                fc._destroyComponent(enemy);\r\n            }\r\n            enemy = fc.addComponent(Enemy);\r\n            enemy.HP = enemy.maxHP;\r\n            let hpbar = fc.getChildByName(\"hpbar\");\r\n            if (!hpbar) {\r\n                hpbar = new Laya.Image();\r\n                hpbar.name = \"hpbar\";\r\n                hpbar.y = -5;\r\n                fc.addChild(hpbar);\r\n            }\r\n            hpbar.graphics.drawRect(0, 0, 16, 4, \"#000000\");\r\n            hpbar.graphics.drawRect(1, 1, 14, 2, \"#ff0000\");\r\n            EnemyFactory.enemylist.push(fc);\r\n            EnemyFactory.mainsp.addChild(fc);\r\n            enemyforce -= Enemy.BattlePoint;\r\n        }\r\n    }\r\n    static clearEnemey() {\r\n        for (let i = 0; i < EnemyFactory.enemylist.length; i++) {\r\n            Laya.Pool.recover('EnemyType', EnemyFactory.enemylist[i]);\r\n            this.mainsp.removeChild(EnemyFactory.enemylist[i]);\r\n        }\r\n        EnemyFactory.enemylist = [];\r\n    }\r\n}\r\n",
  "references": [
    "/Users/huanggaole/PCGZelda/src/script/Region.ts",
    "/Users/huanggaole/PCGZelda/src/character/GrassEnemy1.ts",
    "/Users/huanggaole/PCGZelda/src/character/SandEnemy1.ts",
    "/Users/huanggaole/PCGZelda/src/character/SnowEnemy1.ts",
    "/Users/huanggaole/PCGZelda/src/character/LavaEnemy1.ts",
    "/Users/huanggaole/PCGZelda/src/character/GrassEnemy2.ts",
    "/Users/huanggaole/PCGZelda/src/character/SnowEnemy2.ts",
    "/Users/huanggaole/PCGZelda/src/character/SandEnemy2.ts"
  ]
}
